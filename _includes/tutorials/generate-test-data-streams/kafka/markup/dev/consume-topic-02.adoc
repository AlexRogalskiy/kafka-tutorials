We now have two Kafka topics being written to. The first (`devices`) is keyed on the MAC address, as can be seen from the data: 

+++++
<pre class="snippet"><code class="shell">{% include_raw tutorials/generate-test-data-streams/kafka/code/tutorial-steps/dev/consume-topic-02a.sh %}</code></pre>
+++++

+++++
<pre class="snippet"><code class="shell">{% include_raw tutorials/generate-test-data-streams/kafka/code/tutorial-steps/dev/consume-topic-02a_expected.log %}</code></pre>
+++++

The MAC address is the foreign key for the traffic data that's generated: 

+++++
<pre class="snippet"><code class="shell">{% include_raw tutorials/generate-test-data-streams/kafka/code/tutorial-steps/dev/consume-topic-02b.sh %}</code></pre>
+++++

+++++
<pre class="snippet"><code class="shell">{% include_raw tutorials/generate-test-data-streams/kafka/code/tutorial-steps/dev/consume-topic-02b_expected.log %}</code></pre>
+++++

This set of test data could be used with a stream processor such as ksqlDB to join between the two topics and write out an enriched topic of traffic events that include information about the device to which the traffic relates. link:ksql.html#join-the-test-data-streams-in-ksqldb[See here] if you would like to see an example.